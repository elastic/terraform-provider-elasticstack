---
subcategory: "Kibana"
layout: ""
page_title: "Elasticstack: elasticstack_kibana_security_detection_rule Resource"
description: |-
  Creates or updates a Kibana security detection rule.
---

# Resource: elasticstack_kibana_security_detection_rule

Creates or updates a Kibana security detection rule. Security detection rules are used to detect suspicious activities and generate security alerts based on specified conditions and queries.

See the [Elastic Security detection rules documentation](https://www.elastic.co/guide/en/security/current/rules-api-create.html) for more details.

## Example Usage

### Basic Detection Rule

{{ tffile "examples/resources/elasticstack_kibana_security_detection_rule/resource.tf" }}

## Argument Reference

The following arguments are supported:

### Required Arguments

- `name` - (String) A human-readable name for the rule.
- `query` - (String) The query language definition used to detect events.
- `description` - (String) The rule's description explaining what it detects.

### Optional Arguments

- `space_id` - (String) An identifier for the space. If not provided, the default space is used. **Note**: Changing this forces a new resource to be created.
- `rule_id` - (String) A stable unique identifier for the rule object. If omitted, a UUID is generated. **Note**: Changing this forces a new resource to be created.
- `type` - (String) Rule type. Currently only `query` is supported. Defaults to `"query"`.
- `language` - (String) The query language (`kuery` or `lucene`). Defaults to `"kuery"`.
- `enabled` - (Boolean) Determines whether the rule is enabled. Defaults to `true`.
- `severity` - (String) Severity level of alerts (`low`, `medium`, `high`, `critical`). Defaults to `"medium"`.
- `risk_score` - (Number) A numerical representation of the alert's severity from 0 to 100. Defaults to `50`.
- `from` - (String) Time from which data is analyzed using date math range (e.g., `now-6m`). Defaults to `"now-6m"`.
- `to` - (String) Time to which data is analyzed using date math range. Defaults to `"now"`.
- `interval` - (String) Frequency of rule execution using date math range (e.g., `5m`). Defaults to `"5m"`.
- `index` - (List of String) Indices on which the rule functions. Defaults to Security Solution default indices.
- `author` - (List of String) The rule's author(s).
- `tags` - (List of String) Tags to help categorize, filter, and search rules.
- `license` - (String) The rule's license.
- `false_positives` - (List of String) Common reasons why the rule may issue false-positive alerts.
- `references` - (List of String) References and URLs to sources of additional information.
- `note` - (String) Notes to help investigate alerts produced by the rule.
- `setup` - (String) Setup guide with instructions on rule prerequisites.
- `max_signals` - (Number) Maximum number of alerts the rule can create during a single run. Defaults to `100`.
- `version` - (Number) The rule's version number. Defaults to `1`.

### Read-Only Attributes

- `id` - (String) The internal identifier of the resource in the format `space_id/rule_object_id`.
- `created_at` - (String) The time the rule was created.
- `created_by` - (String) The user who created the rule.
- `updated_at` - (String) The time the rule was last updated.
- `updated_by` - (String) The user who last updated the rule.
- `revision` - (Number) The rule's revision number representing the version of the rule object.

## Import

Security detection rules can be imported using the rule's object ID:

{{ codefile "shell" "examples/resources/elasticstack_kibana_security_detection_rule/import.sh" }}

**Note**: When importing, you may need to adjust the `space_id` in your configuration to match the space where the rule was created.