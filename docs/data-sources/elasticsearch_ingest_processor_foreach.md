---
subcategory: "Ingest"
layout: ""
page_title: "Elasticstack: elasticstack_elasticsearch_ingest_processor_foreach Data Source"
description: |-
  Helper data source to create a processor which runs an ingest processor on each element of an array or object.
---

# Data Source: elasticstack_elasticsearch_ingest_processor_foreach

Runs an ingest processor on each element of an array or object.

All ingest processors can run on array or object elements. However, if the number of elements is unknown, it can be cumbersome to process each one in the same way.

The `foreach` processor lets you specify a `field` containing array or object values and a `processor` to run on each element in the field.

See: https://www.elastic.co/guide/en/elasticsearch/reference/current/foreach-processor.html


### Access keys and values

When iterating through an array or object, the foreach processor stores the current element’s value in the `_ingest._value` ingest metadata field. `_ingest._value` contains the entire element value, including any child fields. You can access child field values using dot notation on the `_ingest._value` field.

When iterating through an object, the foreach processor also stores the current element’s key as a string in `_ingest._key`.

You can access and change `_ingest._key` and `_ingest._value` in the processor.



## Example Usage

```terraform
provider "elasticstack" {
  elasticsearch {}
}

data "elasticstack_elasticsearch_ingest_processor_convert" "convert" {
  field = "_ingest._value"
  type  = "integer"
}

data "elasticstack_elasticsearch_ingest_processor_foreach" "foreach" {
  field     = "values"
  processor = data.elasticstack_elasticsearch_ingest_processor_convert.convert.json
}

resource "elasticstack_elasticsearch_ingest_pipeline" "my_ingest_pipeline" {
  name = "foreach-ingest"

  processors = [
    data.elasticstack_elasticsearch_ingest_processor_foreach.foreach.json
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- **field** (String) Field containing array or object values.
- **processor** (String) Ingest processor to run on each element.

### Optional

- **description** (String) Description of the processor.
- **if** (String) Conditionally execute the processor
- **ignore_failure** (Boolean) Ignore failures for the processor.
- **ignore_missing** (Boolean) If `true`, the processor silently exits without changing the document if the `field` is `null` or missing.
- **on_failure** (List of String) Handle failures for the processor.
- **tag** (String) Identifier for the processor.

### Read-Only

- **id** (String) Internal identifier of the resource
- **json** (String) JSON representation of this data source.
