---
subcategory: "Ingest"
layout: ""
page_title: "Elasticstack: elasticstack_elasticsearch_ingest_processor_network_direction Data Source"
description: |-
  Helper data source to create a processor which calculates the network direction given a source IP address, destination IP address, and a list of internal networks.
---

# Data Source: elasticstack_elasticsearch_ingest_processor_network_direction

Calculates the network direction given a source IP address, destination IP address, and a list of internal networks.

The network direction processor reads IP addresses from Elastic Common Schema (ECS) fields by default. If you use the ECS, only the `internal_networks` option must be specified.


One of either `internal_networks` or `internal_networks_field` must be specified. If `internal_networks_field` is specified, it follows the behavior specified by `ignore_missing`.

### Supported named network rangese

The named ranges supported for the internal_networks option are:

* `loopback` - Matches loopback addresses in the range of 127.0.0.0/8 or ::1/128.
* `unicast` or `global_unicast` - Matches global unicast addresses defined in RFC 1122, RFC 4632, and RFC 4291 with the exception of the IPv4 broadcast address (255.255.255.255). This includes private address ranges.
* `multicast` - Matches multicast addresses.
* `interface_local_multicast` - Matches IPv6 interface-local multicast addresses.
* `link_local_unicast` - Matches link-local unicast addresses.
* `link_local_multicast` - Matches link-local multicast addresses.
* `private` - Matches private address ranges defined in RFC 1918 (IPv4) and RFC 4193 (IPv6).
* `public` - Matches addresses that are not loopback, unspecified, IPv4 broadcast, link local unicast, link local multicast, interface local multicast, or private.
* `unspecified` - Matches unspecified addresses (either the IPv4 address "0.0.0.0" or the IPv6 address "::").


See: https://www.elastic.co/guide/en/elasticsearch/reference/current/network-direction-processor.html


## Example Usage

```terraform
provider "elasticstack" {
  elasticsearch {}
}

data "elasticstack_elasticsearch_ingest_processor_network_direction" "network_direction" {
  internal_networks = ["private"]
}

resource "elasticstack_elasticsearch_ingest_pipeline" "my_ingest_pipeline" {
  name = "network-direction-ingest"

  processors = [
    data.elasticstack_elasticsearch_ingest_processor_network_direction.network_direction.json
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `description` (String) Description of the processor.
- `destination_ip` (String) Field containing the destination IP address.
- `if` (String) Conditionally execute the processor
- `ignore_failure` (Boolean) Ignore failures for the processor.
- `ignore_missing` (Boolean) If `true` and `field` does not exist or is `null`, the processor quietly exits without modifying the document.
- `internal_networks` (Set of String) List of internal networks.
- `internal_networks_field` (String) A field on the given document to read the internal_networks configuration from.
- `on_failure` (List of String) Handle failures for the processor.
- `source_ip` (String) Field containing the source IP address.
- `tag` (String) Identifier for the processor.
- `target_field` (String) Output field for the network direction.

### Read-Only

- `id` (String) Internal identifier of the resource.
- `json` (String) JSON representation of this data source.
