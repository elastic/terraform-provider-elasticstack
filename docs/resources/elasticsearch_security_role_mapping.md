---
subcategory: "Security"
layout: ""
page_title: "Elasticstack: elasticstack_elasticsearch_security_role_mapping Resource"
description: |-
  Adds and updates role mappings.
---

# Resource: elasticstack_elasticsearch_security_role_mapping

Use the following APIs to add, remove, update, and retrieve role mappings. See: https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api.html#security-role-mapping-apis

## Example Usage

```terraform
provider "elasticstack" {
  elasticsearch {}
}

resource "elasticstack_elasticsearch_security_role_mapping" "role_mapping" {
  name    = "testrolemapping"
  enabled = true
  roles = [
    "user",
  ]

  # role_templates can be defined in different ways
  role_templates = [
    # using the jsonencode function, which is the recommended way if you want to provide JSON object yourself
    jsonencode({
      template = {
        source = "saml_user"
      }
    }),

    // or using HEREDOC construct to provide the role_template definition
    <<-EOT
    {
      "template": {
        "source": "_user_{{username}}"
      }
    }
    EOT
  ]

  metadata = jsonencode({
    version = 1
  })
}

output "role_mapping" {
  value = elasticstack_elasticsearch_security_role_mapping.name
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- **enabled** (Boolean) Specifies whether the role mapping is enabled.
- **name** (String) The name of the role mapping.
- **rules** (String) The rules that determine which users should be matched by the mapping.

### Optional

- **elasticsearch_connection** (Block List, Max: 1) Used to establish connection to Elasticsearch server. Overrides environment variables if present. (see [below for nested schema](#nestedblock--elasticsearch_connection))
- **metadata** (String) Optional meta-data.
- **role_templates** (List of String) A list of mustache templates that will be evaluated to determine the roles names that should granted to the users that match the role mapping rules. Each record must be a valid JSON document.
- **roles** (Set of String) A list of role names that are granted to the users that match the role mapping rule. Default is [].

### Read-Only

- **id** (String) Internal identifier of the resource

<a id="nestedblock--elasticsearch_connection"></a>
### Nested Schema for `elasticsearch_connection`

Optional:

- **ca_file** (String) Path to a custom Certificate Authority certificate
- **endpoints** (List of String, Sensitive) A list of endpoints the Terraform provider will point to. They must include the http(s) schema and port number.
- **insecure** (Boolean) Disable TLS certificate validation
- **password** (String, Sensitive) A password to use for API authentication to Elasticsearch.
- **username** (String) A username to use for API authentication to Elasticsearch.

## Import

Import is supported using the following syntax:

```shell
terraform import elasticstack_elasticsearch_security_role_mapping <cluster_uuid>/<role mapping name>
```
