---
subcategory: "Fleet"
layout: ""
page_title: "Elasticstack: elasticstack_fleet_package_policy Resource"
description: |-
  Creates or updates a Fleet Package Policy.
---

# Resource: elasticstack_fleet_package_policy

Creates or updates a Fleet Package Policy.

It is highly recommended that all inputs and streams are provided in the
Terraform plan, even if some are disabled. Otherwise, differences may appear
between what is in the plan versus what is returned by the Fleet API.

The [Kibana Fleet UI](https://www.elastic.co/guide/en/fleet/current/add-integration-to-policy.html)
can be used as a reference for what data needs to be provided. Instead of saving
a new integration configuration, the API request can be previewed, showing what
values need to be provided for inputs and their streams.

## Example Usage

```terraform
provider "elasticstack" {
  fleet {}
}

// The package to use.
resource "elasticstack_fleet_package" "sample" {
  name    = "tcp"
  version = "1.16.0"
  force   = true
}

// An agent policy to hold the package policy.
resource "elasticstack_fleet_agent_policy" "sample" {
  name            = "Sample Agent Policy"
  namespace       = "default"
  description     = "A sample agent policy"
  monitor_logs    = true
  monitor_metrics = true
  skip_destroy    = false
}

// The associated enrollment token.
data "elasticstack_fleet_enrollment_tokens" "sample" {
  policy_id = elasticstack_fleet_agent_policy.sample.policy_id
}

// The package policy.
resource "elasticstack_fleet_package_policy" "sample" {
  name            = "Sample Package Policy"
  namespace       = "default"
  description     = "A sample package policy"
  agent_policy_id = elasticstack_fleet_agent_policy.sample.policy_id
  package_name    = elasticstack_fleet_package.sample.name
  package_version = elasticstack_fleet_package.sample.version

  input {
    input_id = "tcp-tcp"
    streams_json = jsonencode({
      "tcp.generic" : {
        "enabled" : true,
        "vars" : {
          "listen_address" : "localhost",
          "listen_port" : 8080,
          "data_stream.dataset" : "tcp.generic",
          "tags" : [],
          "syslog_options" : "field: message\n#format: auto\n#timezone: Local\n",
          "ssl" : "#certificate: |\n#    -----BEGIN CERTIFICATE-----\n#    ...\n#    -----END CERTIFICATE-----\n#key: |\n#    -----BEGIN PRIVATE KEY-----\n#    ...\n#    -----END PRIVATE KEY-----\n",
          "custom" : ""
        }
      }
    })
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `agent_policy_id` (String) ID of the agent policy.
- `input` (Block List, Min: 1) (see [below for nested schema](#nestedblock--input))
- `name` (String) The name of the package policy.
- `namespace` (String) The namespace of the package policy.
- `package_name` (String) The name of the package.
- `package_version` (String) The version of the package.

### Optional

- `description` (String) The description of the package policy.
- `enabled` (Boolean) Enable the package policy.
- `force` (Boolean) Force operations, such as creation and deletion, to occur.
- `policy_id` (String) Unique identifier of the package policy.
- `vars_json` (String, Sensitive) Package-level variables as JSON.

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--input"></a>
### Nested Schema for `input`

Required:

- `input_id` (String) The identifier of the input.

Optional:

- `enabled` (Boolean) Enable the input.
- `streams_json` (String, Sensitive) Input streams as JSON.
- `vars_json` (String, Sensitive) Input variables as JSON.

## Import

Import is supported using the following syntax:

```shell
terraform import elasticstack_fleet_package_policy.my_policy <fleet_package_policy_id>
```
