---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "elasticstack_elasticsearch_enrich_policy Resource - terraform-provider-elasticstack"
subcategory: "Enrich"
description: |-
  Managing Elasticsearch enrich policies. See the enrich API documentation https://www.elastic.co/guide/en/elasticsearch/reference/current/enrich-apis.html for more details.
---

# elasticstack_elasticsearch_enrich_policy (Resource)

Managing Elasticsearch enrich policies. See the [enrich API documentation](https://www.elastic.co/guide/en/elasticsearch/reference/current/enrich-apis.html) for more details.

## Example Usage

```terraform
provider "elasticstack" {
  elasticsearch {}
}

resource "elasticstack_elasticsearch_index" "my_index" {
  name = "my-index"

  mappings = jsonencode({
    properties = {
      email      = { type = "text" }
      first_name = { type = "text" }
      last_name  = { type = "text" }
    }
  })
  deletion_protection = false
}

resource "elasticstack_elasticsearch_enrich_policy" "policy1" {
  name          = "policy1"
  policy_type   = "match"
  indices       = [elasticstack_elasticsearch_index.my_index.name]
  match_field   = "email"
  enrich_fields = ["first_name", "last_name"]
  query = jsonencode({
    bool = {
      must     = [{ term = { b = "A" } }]
      must_not = [{ term = { a = "B" } }]
    }
  })
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `enrich_fields` (Set of String) Fields to add to matching incoming documents. These fields must be present in the source indices.
- `indices` (Set of String) Array of one or more source indices used to create the enrich index.
- `match_field` (String) Field in source indices used to match incoming documents.
- `name` (String) Name of the enrich policy to manage.
- `policy_type` (String) The type of enrich policy, can be one of geo_match, match, range.

### Optional

- `elasticsearch_connection` (Block List, Deprecated) Elasticsearch connection configuration block. (see [below for nested schema](#nestedblock--elasticsearch_connection))
- `execute` (Boolean) Whether to call the execute API function in order to create the enrich index.
- `query` (String) Query used to filter documents in the enrich index. The policy only uses documents matching this query to enrich incoming documents. Defaults to a match_all query.

### Read-Only

- `id` (String) Internal identifier of the resource

<a id="nestedblock--elasticsearch_connection"></a>
### Nested Schema for `elasticsearch_connection`

Optional:

- `api_key` (String, Sensitive) API Key to use for authentication to Elasticsearch
- `bearer_token` (String, Sensitive) Bearer Token to use for authentication to Elasticsearch
- `ca_data` (String) PEM-encoded custom Certificate Authority certificate
- `ca_file` (String) Path to a custom Certificate Authority certificate
- `cert_data` (String) PEM encoded certificate for client auth
- `cert_file` (String) Path to a file containing the PEM encoded certificate for client auth
- `endpoints` (List of String, Sensitive) A list of endpoints where the terraform provider will point to, this must include the http(s) schema and port number.
- `es_client_authentication` (String, Sensitive) ES Client Authentication field to be used with the JWT token
- `headers` (Map of String, Sensitive) A list of headers to be sent with each request to Elasticsearch.
- `insecure` (Boolean) Disable TLS certificate validation
- `key_data` (String, Sensitive) PEM encoded private key for client auth
- `key_file` (String) Path to a file containing the PEM encoded private key for client auth
- `password` (String, Sensitive) Password to use for API authentication to Elasticsearch.
- `username` (String) Username to use for API authentication to Elasticsearch.

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
# NOTE: while importing index resource, keep in mind, that some of the default index settings will be imported into the TF state too
# You can later adjust the index configuration to account for those imported settings
terraform import elasticstack_elasticsearch_enrich_policy.policy1 <cluster_uuid>/<policy_name>
```
