---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "elasticstack_kibana_security_enable_rule Resource - terraform-provider-elasticstack"
subcategory: "Kibana"
description: |-
  Enables Elastic Security detection rules based on tags.
  This resource uses Kibana’s bulk action API to enable all rules matching the specified tag key-value pair.
  Requires Elastic Stack version 8.11.0 or higher. See the documentation https://www.elastic.co/guide/en/security/current/rules-ui-management.html for more details.
---

# elasticstack_kibana_security_enable_rule (Resource)

Enables Elastic Security detection rules based on tags.

This resource uses Kibana’s bulk action API to enable all rules matching the specified tag key-value pair.

Requires Elastic Stack version 8.11.0 or higher. See the [documentation](https://www.elastic.co/guide/en/security/current/rules-ui-management.html) for more details.

## Example Usage

```terraform
provider "elasticstack" {
  kibana {}
}

# Enable all Windows rules
resource "elasticstack_kibana_security_enable_rule" "windows" {
  space_id = "default"
  key      = "OS"
  value    = "Windows"
}

# Enable rules but don't disable them when the resource is destroyed
resource "elasticstack_kibana_security_enable_rule" "macos_persistent" {
  space_id           = "default"
  key                = "OS"
  value              = "macOS"
  disable_on_destroy = false
}

# Enable all Linux rules
resource "elasticstack_kibana_security_enable_rule" "linux" {
  space_id = "default"
  key      = "OS"
  value    = "Linux"
}

# Enable rules in a custom space
resource "elasticstack_kibana_security_enable_rule" "custom_space" {
  space_id = "security"
  key      = "Data Source"
  value    = "Elastic Defend"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `key` (String) The tag key to filter rules by (e.g., 'OS').
- `value` (String) The tag value to filter rules by (e.g., 'Windows').

### Optional

- `disable_on_destroy` (Boolean) Whether to disable the rules when this resource is destroyed. Defaults to true.
- `space_id` (String) An identifier for the space. If space_id is not provided, the default space is used.

### Read-Only

- `all_rules_enabled` (Boolean) Computed attribute indicating whether all rules matching the tag are currently enabled. Used for drift detection.
- `id` (String) The ID of this resource.
