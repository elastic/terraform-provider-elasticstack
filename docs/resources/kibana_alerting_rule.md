---
subcategory: "Kibana"
layout: ""
page_title: "Elasticstack: elasticstack_kibana_alerting_rule Resource"
description: |-
  Creates or updates a Kibana alerting rule.
---

# Resource: elasticstack_kibana_alerting_rule

Creates or updates a Kibana alerting rule. See https://www.elastic.co/guide/en/kibana/current/create-and-manage-rules.html

## Example Usage

```terraform
provider "elasticstack" {
  kibana {}
}

resource "elasticstack_kibana_alerting_rule" "example" {
  name        = "%s"
  consumer    = "alerts"
  notify_when = "onActiveAlert"
  params = jsonencode({
    aggType             = "avg"
    groupBy             = "top"
    termSize            = 10
    timeWindowSize      = 10
    timeWindowUnit      = "s"
    threshold           = [10]
    thresholdComparator = ">"
    index               = ["test-index"]
    timeField           = "@timestamp"
    aggField            = "version"
    termField           = "name"
  })
  rule_type_id = ".index-threshold"
  interval     = "1m"
  enabled      = true
}
```


**NOTE:** `api_key` authentication is only supported for alerting rule resources from version 8.8.0 of the Elastic stack. Using an `api_key` will result in an error message like:

```
Could not create API key - Unsupported scheme "ApiKey" for granting API Key
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `consumer` (String) The name of the application or feature that owns the rule.
- `interval` (String) The check interval, which specifies how frequently the rule conditions are checked. The interval must be specified in seconds, minutes, hours or days.
- `name` (String) The name of the rule. While this name does not have to be unique, a distinctive name can help you identify a rule.
- `params` (String) The rule parameters, which differ for each rule type.
- `rule_type_id` (String) The ID of the rule type that you want to call when the rule is scheduled to run. For more information about the valid values, list the rule types using [Get rule types API](https://www.elastic.co/guide/en/kibana/master/list-rule-types-api.html) or refer to the [Rule types documentation](https://www.elastic.co/guide/en/kibana/master/rule-types.html).

### Optional

- `actions` (Block List) An action that runs under defined conditions. (see [below for nested schema](#nestedblock--actions))
- `alert_delay` (Number) A number that indicates how many consecutive runs need to meet the rule conditions for an alert to occur.
- `enabled` (Boolean) Indicates if you want to run the rule on an interval basis.
- `notify_when` (String) Required until v8.6.0. Deprecated in v8.13.0. Use the `notify_when` property in the action `frequency` object instead. Defines how often alerts generate actions. Valid values include: `onActionGroupChange`: Actions run when the alert status changes; `onActiveAlert`: Actions run when the alert becomes active and at each check interval while the rule conditions are met; `onThrottleInterval`: Actions run when the alert becomes active and at the interval specified in the throttle property while the rule conditions are met. NOTE: This is a rule level property; if you update the rule in Kibana, it is automatically changed to use action-specific `notify_when` values.
- `rule_id` (String) A UUID v1 or v4 to use instead of a randomly generated ID.
- `space_id` (String) An identifier for the space. If space_id is not provided, the default space is used.
- `tags` (List of String) A list of tag names that are applied to the rule.
- `throttle` (String) Deprecated in 8.13.0. Defines how often an alert generates repeated actions. This custom action interval must be specified in seconds, minutes, hours, or days. For example, 10m or 1h. This property is applicable only if `notify_when` is `onThrottleInterval`. NOTE: This is a rule level property; if you update the rule in Kibana, it is automatically changed to use action-specific `throttle` values.

### Read-Only

- `id` (String) The ID of this resource.
- `last_execution_date` (String) Date of the last execution of this rule.
- `last_execution_status` (String) Status of the last execution of this rule.
- `scheduled_task_id` (String) ID of the scheduled task that will execute the alert.

<a id="nestedblock--actions"></a>
### Nested Schema for `actions`

Required:

- `id` (String) The identifier for the connector saved object.
- `params` (String) The parameters for the action, which are sent to the connector.

Optional:

- `frequency` (Block List, Max: 1) The properties that affect how often actions are generated. If the rule type supports setting summary to true, the action can be a summary of alerts at the specified notification interval. Otherwise, an action runs for each alert at the specified notification interval. NOTE: You cannot specify these parameters when `notify_when` or `throttle` are defined at the rule level. (see [below for nested schema](#nestedblock--actions--frequency))
- `group` (String) The group name, which affects when the action runs (for example, when the threshold is met or when the alert is recovered). Each rule type has a list of valid action group names.

<a id="nestedblock--actions--frequency"></a>
### Nested Schema for `actions.frequency`

Required:

- `notify_when` (String) Defines how often alerts generate actions. Valid values include: `onActionGroupChange`: Actions run when the alert status changes; `onActiveAlert`: Actions run when the alert becomes active and at each check interval while the rule conditions are met; `onThrottleInterval`: Actions run when the alert becomes active and at the interval specified in the throttle property while the rule conditions are met. NOTE: This is a rule level property; if you update the rule in Kibana, it is automatically changed to use action-specific `notify_when` values.
- `summary` (Boolean) Indicates whether the action is a summary.

Optional:

- `throttle` (String) Defines how often an alert generates repeated actions. This custom action interval must be specified in seconds, minutes, hours, or days. For example, 10m or 1h. This property is applicable only if `notify_when` is `onThrottleInterval`. NOTE: This is a rule level property; if you update the rule in Kibana, it is automatically changed to use action-specific `throttle` values.

## Import

Import is supported using the following syntax:

```shell
terraform import elasticstack_kibana_alerting_rule.my_rule <space id>/<rule id>
```
